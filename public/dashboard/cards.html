<!DOCTYPE html>
<html lang="pt-br">

<head>
  <link rel="shortcut icon" href="../assets/icon/favicon.ico" type="image/x-icon" />
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>card</title>
  <link rel="stylesheet" href="style_dash.css" />
  <script src="../js/funcoes.js"></script>
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link
    href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet" />
</head>

<body onload="validarSessao(), atualizacaoPeriodica()">

  <!-- atualizacaoPeriodica() -->
  <div class="janela">
    <div class="header-left dash-header">
      <h1>Cards</h1>

      <div class="hello">
        <h3>
          Olá, <span id="b_usuario">usuário</span>! <br /><br />
          Vi que seu album favorito é <span id="b_usuario_album">album</span>
        </h3>
      </div>

      <div class="btn-nav">
        <a href="dashboard.html">
          <h3>Gráficos</h3>
        </a>
      </div>

      <div class="btn-logout" onclick="limparSessao()">
        <h3>Sair</h3>
      </div>
    </div>

    <div class="dash">

      <div class="regua">
        <div class="item-regua perigo-frio">
          <h2>Menos ouvido</h2>
        </div>
        <!-- <div class="item-regua alerta-frio">
            <h2>19 | 22</h2>
          </div> -->
        <div class="item-regua ideal">
          <h2>Ouvido</h2>
        </div>
        <!-- <div class="item-regua alerta-quente">
            <h2>28 | 32</h2>
          </div> -->
        <div class="item-regua perigo-quente">
          <h2>Mais ouvido</h2>
        </div>
      </div>

      <div class="cards">
        <div class="card">
          <h1>Please Please Me</h1>
          <div class="capa_album">
            <p id="temp_aquario_1"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/please_please_me.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_1"></div>
        </div>
        <div class="card">
          <h1>With The Beatles</h1>
          <div class="capa_album">
            <p id="temp_aquario_2"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/with_the_beatles.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_2"></div>
        </div>
        <div class="card">
          <h1>A Hard Day's Night</h1>
          <div class="capa_album">
            <p id="temp_aquario_3"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/a_hard_days_night.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_3"></div>
        </div>
        <div class="card">
          <h1>Beatles For Sale</h1>
          <div class="capa_album">
            <p id="temp_aquario_4"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/beatles_for_sale.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_4"></div>
        </div>
        <div class="card">
          <h1>Help!</h1>
          <div class="capa_album">
            <p id="temp_aquario_5"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/help.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_5"></div>
        </div>
        <div class="card">
          <h1>Rubber Soul</h1>
          <div class="capa_album">
            <p id="temp_aquario_6"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/rubber_soul.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_6"></div>
        </div>
        <div class="card">
          <h1>Revolver</h1>
          <div class="capa_album">
            <p id="temp_aquario_7"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/revolver.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_7"></div>
        </div>
        <div class="card">
          <h1>Sgt.Pepper's Lonely Hearts Club Band</h1>
          <div class="capa_album">
            <p id="temp_aquario_8"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/sgt_peppers.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_8"></div>
        </div>
        <div class="card">
          <h1>Magical Mystery Tour</h1>
          <div class="capa_album">
            <p id="temp_aquario_9"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/magical_mystery_tour.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_9"></div>
        </div>
        <div class="card">
          <h1>The Beatles - White album</h1>
          <div class="capa_album">
            <p id="temp_aquario_10"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/white_album.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_10"></div>
        </div>
        <div class="card">
          <h1>Yellow Submarine</h1>
          <div class="capa_album">
            <p id="temp_aquario_11"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/yellow_submarine.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_11"></div>
        </div>
        <div class="card">
          <h1>Abbey Road</h1>
          <div class="capa_album">
            <p id="temp_aquario_12"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/abbey_road.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_12"></div>
        </div>
        <div class="card">
          <h1>Let It Be</h1>
          <div class="capa_album">
            <p id="temp_aquario_13"></p>
            <img class="tamanho_album" src="../assets/imgs/albums/let_it_be.jpg" alt="" />
          </div>
          <div class="cor-alerta" id="card_13"></div>
        </div>
      </div>
      <div class="bubbles">
        <span style="--i: 11"></span>
        <span style="--i: 12"></span>
        <span style="--i: 24"></span>
        <span style="--i: 10"></span>
        <span style="--i: 14"></span>
        <span style="--i: 23"></span>
        <span style="--i: 18"></span>
        <span style="--i: 16"></span>
        <span style="--i: 19"></span>
        <span style="--i: 20"></span>
        <span style="--i: 22"></span>
        <span style="--i: 25"></span>
        <span style="--i: 18"></span>
        <span style="--i: 21"></span>
        <span style="--i: 15"></span>
        <span style="--i: 13"></span>
        <span style="--i: 26"></span>
        <span style="--i: 17"></span>
        <span style="--i: 13"></span>
        <span style="--i: 28"></span>
        <span style="--i: 29"></span>
        <span style="--i: 30"></span>
      </div>
    </div>
  </div>
</body>

<script>
  function atualizacaoPeriodica() {
    obterdados(1);
    // obterdados(2);
    // obterdados(3);
    // obterdados(4);

    function sendData() {
      var http = new XMLHttpRequest();
      http.open("POST", "http://localhost:3000/api/sendData", false);
      // http.send(null);
    }

    setInterval(() => {
      sendData();
    }, 2000);
    setTimeout(atualizacaoPeriodica, 5000);
  }

  function obterdados(idAquario) {
    fetch(`/medidas/tempo-real/${idAquario}`)
      .then((resposta) => {
        if (resposta.ok) {
          resposta.json().then((resposta) => {
            console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);

            var dados = {
              Nome_album: resposta[0].nome_album,
              votos: resposta[0].fk_album,
            };
            
            album = [
            resposta[0].nome_album,
            resposta[1].nome_album, 
            resposta[2].nome_album, 
            resposta[3].nome_album,
            resposta[4].nome_album,
            resposta[5].nome_album,
            resposta[6].nome_album,
            resposta[7].nome_album,
            resposta[8].nome_album,
            resposta[9].nome_album,
            resposta[10].nome_album,
            resposta[11].nome_album,
            resposta[12].nome_album
          ]

            qtd_votos = [
              resposta[0].fk_album,
              resposta[1].fk_album, 
              resposta[2].fk_album, 
              resposta[3].fk_album,
              resposta[4].fk_album,
              resposta[5].fk_album,
              resposta[6].fk_album,
              resposta[7].fk_album,
              resposta[8].fk_album,
              resposta[9].fk_album,
              resposta[10].fk_album,
              resposta[11].fk_album,
              resposta[12].fk_album
            ]

            alertar(resposta[0].temperatura, idAquario, resposta[0].umidade);
          });
        } else {
          console.error("Nenhum dado encontrado ou erro na API");
        }
      })
      .catch(function (error) {
        console.error(
          `Erro na obtenção dos dados do aquario p/ gráfico: ${error.message}`
        );
      });
  }

  var album = []
  var qtd_votos = []


  function alertar(nome_album, fk_album) {

    var limites = {
      pouco_ouvido: 7,
      bem_ouvido: 8,
      muito_ouvido: 10, 
    };

    if (fk_album == limites.muito_frio) {
      console.log(`caiu no if ${fk_album}`)

    } else {
      console.log('Caiu no else')
    }

  }
</script>

</html>